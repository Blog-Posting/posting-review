# 관계형 데이터베이스의 가상 테이블



오늘날 데이터베이스 기술은 복수의 테이블을 기반으로 한다. 복수의 테이블에서, 각 테이블이 서로 다른 정보의 집합을 저장하지만, 다양한 테이블에 있는 개체(object)들은 어떤 식으로든 서로 연결된다. 예를 들어, 회사 데이터베이스는 고객 정보, 공급자 정보, 제품 정보에 대해 개별 테이블로 구성될 수 있다. 하지만, 고객이 제품을 주문하므로 고객 테이블은 제품 테이블에 있는 항목을 참조한다. 또는, 제품 테이블이 공급자 테이블의 항목을 참조한다. 제품을 공급자의 상품으로부터 제조하기 때문이다.

대학에서 어떤 학생이 무슨 강의를 듣는지 기록하여 저장한 정보를 생각해보자.

| **학생** **이름** | **강의** **번호** | **강의** **제목** | **강사** | **강의실** |
| ----------------- | ----------------- | ----------------- | -------- | ---------- |
| 프란체스카        | ARCH101           | 고고학 개론       | 블랙     | 610        |
| 프란체스카        | HIST256           | 유럽사            | 스미스   | 851        |
| 수잔              | MATH314           | 미분 방정식       | 커비     | 560        |
| 에릭              | MATH314           | 미분 방정식       | 커비     | 560        |
| 루이지            | HIST256           | 유럽사            | 스미스   | 851        |
| 루이지            | MATH314           | 미분 방정식       | 커비     | 560        |
| 빌                | ARCH101           | 고고학 개론       | 블랙     | 610        |
| 빌                | HIST256           | 유럽사            | 스미스   | 851        |
| 로즈              | MATH314           | 미분 방정식       | 커비     | 560        |
| 로즈              | ARCH101           | 고고학 개론       | 블랙     | 610        |

이 데이터를 저장한 방식에서 문제가 있다. 데이터가 불필요하게 반복된다는 것이다. 같은 정보를 저장하는 더 효율적인 방법이 없을까? 강의에 관한 정보가 중복이 됨을 알 수 있다. 예를 들어, ARCH101을 수강하는 학생이 3명인데, 이 강의에 관한 정보들(강의 제목, 강사, 강의실) 가 세 학생의 행에서 반복된다.

이 정보를 저장하려면 다른 2 개의 테이블을 사용한다.

| **학생** **이름** | **강의** **번호** |
| ----------------- | ----------------- |
| 프란체스카        | ARCH101           |
| 프란체스카        | HIST256           |
| 수잔              | MATH314           |
| 에릭              | MATH314           |
| 루이지            | HIST256           |
| 루이지            | MATH314           |
| 빌                | ARCH101           |
| 빌                | HIST256           |
| 로즈              | MATH314           |
| 로즈              | ARCH101           |

| **강의** **번호** | **강의** **제목** | **강사** | **강의실** |
| ----------------- | ----------------- | -------- | ---------- |
| ARCH101           | 고고학 개론       | 블랙     | 610        |
| HIST256           | 유럽사            | 스미스   | 851        |
| MATH314           | 미분 방정식       | 커비     | 560        |



이렇게 복수 테이블의 가장 큰 이점은 저장해야할 정보의 양이 줄어든다는 것이다. 

가상 테이블 트릭은 새로운 테이블을 일시적으로만 생성하는 기법이다.  데이터베이스의 모든 정보는 고정된 테이블에 저장되는데, 왜 임시 테이블을 사용하는걸까? 위 테이블에서 커비 교수의 강의를 수강하는 모든 학생의 이름을 요청하는 쿼리를 입력한다고 하자. 두 테이블의 **조인(join)**이라는 연산을 이용하면 새로운 가상 테이블을 만들 수 있다. 예를 들어, 표의 '강의 번호' 열을 키로사용하여 조인하면 3번째 테이블이 만들어진다. 만약 학생 이름과 강사에 대해서만 알고 싶다면 그 밖의 다른 열은 필요하지 않다. 이렇게 관심 없는 열을 버릴려면, **프로젝션(projection) 연산**을 사용하면 된다. 따라서 데이터베이스는 두 테이블을 먼저 조인 연산하여 열을 제거하는 추출 연산을 통해 다음과 같은 가상 테이블을 산출한다.

| **학생** **이름** | **강사** |
| ----------------- | -------- |
| 프란체스카        | 블랙     |
| 프란체스카        | 스미스   |
| 수잔              | 커비     |
| 에릭              | 커비     |
| 루이지            | 스미스   |
| 루이지            | 커비     |
| 빌                | 블랙     |
| 빌                | 스미스   |
| 로즈              | 커비     |
| 로즈              | 블랙     |



개발자들이 자주 사용하는 셀렉트(select) 또한 가상 테이블을 만드는 연산이다. 셀렉트 연산은 테이블에서 일부 열을 선택하여 나머지 행을 버려 새로운 가상 테이블을 만든다. 예를 들어, 커비 교수의 강의를 듣는 학생을 찾는다면, 강사가 '커비'인 행만을 고르는 '셀렉트' 연산을 수행한다. 

| **학생** **이름** | **강사** |
| ----------------- | -------- |
| 수잔              | 커비     |
| 에릭              | 커비     |
| 루이지            | 커비     |
| 로즈              | 커비     |

가상 테이블이 만들어지고 이제 프로젝션 연산을 한 번 더하면, '강사' 열을 버릴 수 있다.

| **학생** **이름** |
| ----------------- |
| 수잔              |
| 에릭              |
| 루이지            |
| 로즈              |





---

미래를 바꾼 아홉가지 알고리즘. 존 매코믹 지음. 민병교 옮김. 2012. 에이콘

